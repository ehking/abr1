{% extends "base.html" %}
{% block title %}پروژه‌ها{% endblock %}
{% block content %}

<div class="card">
    <h2>پروژه جدید</h2>
    <p style="font-size:12px;color:#9ca3af;margin-top:0;">
        فایل صوتی (آهنگ / ویس) و ویدیوی خام را انتخاب کنید. بعد از ساخت پروژه،
        اولین جاب به صورت خودکار ایجاد و به صف اضافه می‌شود.
    </p>
    <form method="post" enctype="multipart/form-data">
        <div style="margin-bottom:8px;">
            <label for="name">نام پروژه (اختیاری)</label>
            <input type="text" id="name" name="name" placeholder="مثلاً: رهایم کن - ورژن اینستاگرام">
        </div>
        <div style="margin-bottom:8px;">
            <label for="audio">فایل صوتی (mp3/wav)</label>
            <input type="file" id="audio" name="audio" accept="audio/*" required>
        </div>
        <div style="margin-bottom:8px;">
            <label for="video">فایل ویدیوی خام</label>
            <input type="file" id="video" name="video" accept="video/*" required>
        </div>
        <button type="submit">ساخت پروژه + جاب</button>
    </form>
</div>

<div class="card">
    <h2>لیست پروژه‌ها</h2>
    {% if projects %}
    <table>
        <thead>
            <tr>
                <th>پروژه</th>
                <th>فایل‌ها</th>
                <th>زمان</th>
            </tr>
        </thead>
        <tbody>
        {% for p in projects %}
            <tr>
                <td>
                    <a href="{{ url_for('project_detail', project_id=p.id) }}">
                        {{ p.name }}
                    </a>
                </td>
                <td style="font-size:11px;color:#9ca3af;">
                    صوت: {{ p.audio_path|replace(request.root_path,'') }}<br>
                    ویدیو: {{ p.video_path|replace(request.root_path,'') }}
                </td>
                <td style="font-size:11px;color:#9ca3af;">
                    {{ p.created_at.strftime('%Y-%m-%d %H:%M:%S') if p.created_at else '' }}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
      <p style="font-size:12px;color:#9ca3af;">هنوز هیچ پروژه‌ای ثبت نشده است.</p>
    {% endif %}
</div>

{% endblock %}
